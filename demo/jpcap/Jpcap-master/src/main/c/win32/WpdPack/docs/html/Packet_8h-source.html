<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>WinPcap: Packet.h Source File</title>
<link href="style.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>Packet.h</h1><a href="Packet_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 1999 - 2005 NetGroup, Politecnico di Torino (Italy)</span>
<a name="l00003"></a>00003 <span class="comment"> * Copyright (c) 2005 - 2006 CACE Technologies, Davis (California)</span>
<a name="l00004"></a>00004 <span class="comment"> * All rights reserved.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00007"></a>00007 <span class="comment"> * modification, are permitted provided that the following conditions</span>
<a name="l00008"></a>00008 <span class="comment"> * are met:</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * 1. Redistributions of source code must retain the above copyright</span>
<a name="l00011"></a>00011 <span class="comment"> * notice, this list of conditions and the following disclaimer.</span>
<a name="l00012"></a>00012 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
<a name="l00013"></a>00013 <span class="comment"> * notice, this list of conditions and the following disclaimer in the</span>
<a name="l00014"></a>00014 <span class="comment"> * documentation and/or other materials provided with the distribution.</span>
<a name="l00015"></a>00015 <span class="comment"> * 3. Neither the name of the Politecnico di Torino, CACE Technologies </span>
<a name="l00016"></a>00016 <span class="comment"> * nor the names of its contributors may be used to endorse or promote </span>
<a name="l00017"></a>00017 <span class="comment"> * products derived from this software without specific prior written </span>
<a name="l00018"></a>00018 <span class="comment"> * permission.</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00021"></a>00021 <span class="comment"> * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00022"></a>00022 <span class="comment"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00023"></a>00023 <span class="comment"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00024"></a>00024 <span class="comment"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00025"></a>00025 <span class="comment"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00026"></a>00026 <span class="comment"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00027"></a>00027 <span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00028"></a>00028 <span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00029"></a>00029 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00030"></a>00030 <span class="comment"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00031"></a>00031 <span class="comment"> *</span>
<a name="l00032"></a>00032 <span class="comment"> */</span>
<a name="l00033"></a>00033 
<a name="l00042"></a>00042 <span class="preprocessor">#ifndef __PACKET_INCLUDE______</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">#define __PACKET_INCLUDE______</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00045"></a>00045 <span class="preprocessor">#ifdef __NPF_x86__</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span><span class="preprocessor">#define NTKERNEL    </span>
<a name="l00047"></a>00047 <span class="preprocessor">#include "jitter.h"</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a>00050 <span class="comment">//</span>
<a name="l00051"></a>00051 <span class="comment">// Needed to disable a warning due to the #pragma prefast directives,</span>
<a name="l00052"></a>00052 <span class="comment">// that are ignored by the normal DDK compiler</span>
<a name="l00053"></a>00053 <span class="comment">//</span>
<a name="l00054"></a>00054 <span class="preprocessor">#ifndef _PREFAST_</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor">#pragma warning(disable:4068)</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>
<a name="l00058"></a>00058 <span class="preprocessor">#include "win_bpf.h"</span>
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="group__NPF__include.html#g8fc96cee4177a369a99de7026ebeba81">00060</a> <span class="preprocessor">#define  MAX_REQUESTS   32 </span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00062"></a><a class="code" href="group__NPF__include.html#g8463d2101446f74b83ed10006d772384">00062</a> <span class="preprocessor"></span><span class="preprocessor">#define Packet_ALIGNMENT sizeof(int) </span>
<a name="l00063"></a><a class="code" href="group__NPF__include.html#g6ad53095b69ed77878dc683754e3264a">00063</a> <span class="preprocessor">#define Packet_WORDALIGN(x) (((x)+(Packet_ALIGNMENT-1))&amp;~(Packet_ALIGNMENT-1))  </span>
<a name="l00064"></a>00064 <span class="preprocessor"></span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>
<a name="l00066"></a><a class="code" href="group__NPF__include.html#g9cd2ca337001428aa9e1cb512a28ecc2">00066</a> <span class="preprocessor"></span><span class="preprocessor">#define KERNEL_EVENT_NAMESPACE L"\\BaseNamedObjects\\"</span>
<a name="l00067"></a>00067 <span class="preprocessor"></span>
<a name="l00068"></a>00068 <span class="comment">/***************************/</span>
<a name="l00069"></a>00069 <span class="comment">/*         IOCTLs          */</span>
<a name="l00070"></a>00070 <span class="comment">/***************************/</span>
<a name="l00071"></a>00071 
<a name="l00080"></a><a class="code" href="group__NPF__include.html#g71817d3a52bf0ec819934a5f688a172c">00080</a> <span class="preprocessor">#define  BIOCSETBUFFERSIZE 9592</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span>
<a name="l00092"></a><a class="code" href="group__NPF__include.html#gf85f500f68404076ac60ffe6e08818da">00092</a> <span class="preprocessor">#define  BIOCSETF 9030</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span>
<a name="l00100"></a><a class="code" href="group__NPF__include.html#g8ae8be8faa281644d8be1cda38b826bd">00100</a> <span class="preprocessor">#define  BIOCGSTATS 9031</span>
<a name="l00101"></a>00101 <span class="preprocessor"></span>
<a name="l00107"></a><a class="code" href="group__NPF__include.html#g327015c2b2e347212b571d1fa3aa2f54">00107</a> <span class="preprocessor">#define  BIOCSRTIMEOUT 7416</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>
<a name="l00116"></a><a class="code" href="group__NPF__include.html#gd1012b82859d09864d246b1fa99d48d6">00116</a> <span class="preprocessor">#define  BIOCSMODE 7412</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span>
<a name="l00124"></a><a class="code" href="group__NPF__include.html#g1436997ce2947bbbe22b5400254438a1">00124</a> <span class="preprocessor">#define  BIOCSWRITEREP 7413</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span>
<a name="l00131"></a><a class="code" href="group__NPF__include.html#ga827e3441e3f84abc7df5e30fcee96d1">00131</a> <span class="preprocessor">#define  BIOCSMINTOCOPY 7414</span>
<a name="l00132"></a>00132 <span class="preprocessor"></span>
<a name="l00138"></a><a class="code" href="group__NPF__include.html#gbf9a4779fd5281607510edc8b5d766dd">00138</a> <span class="preprocessor">#define  BIOCSETOID 2147483648</span>
<a name="l00139"></a>00139 <span class="preprocessor"></span>
<a name="l00145"></a><a class="code" href="group__NPF__include.html#g5a0ab3231052ff323817e288dab2f127">00145</a> <span class="preprocessor">#define  BIOCQUERYOID 2147483652</span>
<a name="l00146"></a>00146 <span class="preprocessor"></span>
<a name="l00154"></a><a class="code" href="group__NPF__include.html#gc8b51f8abae12f57a2ea8e8e4c0cd53c">00154</a> <span class="preprocessor">#define  BIOCSETDUMPFILENAME 9029</span>
<a name="l00155"></a>00155 <span class="preprocessor"></span>
<a name="l00162"></a><a class="code" href="group__NPF__include.html#gdd9e03a96d297a33d7cee4d750c34eff">00162</a> <span class="preprocessor">#define  BIOCGEVNAME 7415</span>
<a name="l00163"></a>00163 <span class="preprocessor"></span>
<a name="l00171"></a><a class="code" href="group__NPF__include.html#gc50830dc08762383dcb203a66e5c853d">00171</a> <span class="preprocessor">#define  BIOCSENDPACKETSNOSYNC 9032</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span>
<a name="l00181"></a><a class="code" href="group__NPF__include.html#gb4d41e91e460bb101ef8ddb622a8e010">00181</a> <span class="preprocessor">#define  BIOCSENDPACKETSSYNC 9033</span>
<a name="l00182"></a>00182 <span class="preprocessor"></span>
<a name="l00189"></a><a class="code" href="group__NPF__include.html#g3205efe3271948f253c4da5abf0e12c6">00189</a> <span class="preprocessor">#define  BIOCSETDUMPLIMITS 9034</span>
<a name="l00190"></a>00190 <span class="preprocessor"></span>
<a name="l00197"></a><a class="code" href="group__NPF__include.html#g874d333aca88363bc6fdcb3e8b1af05b">00197</a> <span class="preprocessor">#define BIOCISDUMPENDED 7411</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span>
<a name="l00204"></a><a class="code" href="group__NPF__include.html#ge02ae71d6fe0bfb4b600f8027dc90ba3">00204</a> <span class="preprocessor">#define  BIOCISETLOBBEH 7410            </span>
<a name="l00205"></a>00205 <span class="preprocessor"></span>
<a name="l00215"></a><a class="code" href="group__NPF__include.html#g31c73f09a27bb38a6040a5841096576a">00215</a> <span class="preprocessor">#define BIOCSETEVENTHANDLE 7920</span>
<a name="l00216"></a>00216 <span class="preprocessor"></span>
<a name="l00217"></a>00217 <span class="comment">// Working modes</span>
<a name="l00218"></a><a class="code" href="group__NPF__include.html#gc93c0a6ad1d2a3143b1115bdab3ac04d">00218</a> <span class="preprocessor">#define MODE_CAPT 0x0       </span>
<a name="l00219"></a><a class="code" href="group__NPF__include.html#g503326906a62e96c147ae6af31fb5659">00219</a> <span class="preprocessor">#define MODE_STAT 0x1       </span>
<a name="l00220"></a><a class="code" href="group__NPF__include.html#g528e7e542cb1a028a10a3a318880dffb">00220</a> <span class="preprocessor">#define MODE_MON  0x2       </span>
<a name="l00221"></a><a class="code" href="group__NPF__include.html#g89853f93dc8cc890b0665629d16d2831">00221</a> <span class="preprocessor">#define MODE_DUMP 0x10      </span>
<a name="l00222"></a>00222 <span class="preprocessor"></span>
<a name="l00223"></a>00223 <span class="preprocessor"></span>
<a name="l00224"></a><a class="code" href="group__NPF__include.html#g4f6749b7708a411df2a3341a3fcef917">00224</a> <span class="preprocessor">#define IMMEDIATE 1         </span>
<a name="l00225"></a>00225 <span class="preprocessor"></span>
<a name="l00226"></a><a class="code" href="group__NPF__include.html#g0a110077bb4fcbcc75512d8988c90de8">00226</a> <span class="preprocessor"></span><span class="preprocessor">#define NDIS_FLAGS_SKIP_LOOPBACK_W2K    0x400 </span>
<a name="l00227"></a>00227 <span class="preprocessor"></span>
<a name="l00228"></a>00228 <span class="preprocessor"></span><span class="comment">// The following definitions are used to provide compatibility </span>
<a name="l00229"></a>00229 <span class="comment">// of the dump files with the ones of libpcap</span>
<a name="l00230"></a><a class="code" href="group__NPF__include.html#gfedcc0aa0cf5abe7b20c68eefdfcb126">00230</a> <span class="preprocessor">#define TCPDUMP_MAGIC 0xa1b2c3d4    </span>
<a name="l00231"></a><a class="code" href="group__NPF__include.html#gac031371d41e21ff96e80409e05a7ddb">00231</a> <span class="preprocessor">#define PCAP_VERSION_MAJOR 2        </span>
<a name="l00232"></a><a class="code" href="group__NPF__include.html#g9c200b070c9f626d38184588b16849c2">00232</a> <span class="preprocessor">#define PCAP_VERSION_MINOR 4        </span>
<a name="l00233"></a>00233 <span class="preprocessor"></span>
<a name="l00234"></a>00234 <span class="preprocessor"></span><span class="comment">// Loopback behaviour definitions</span>
<a name="l00235"></a><a class="code" href="group__NPF__include.html#g7ccc8974741059b5ae25231a56dbed09">00235</a> <span class="preprocessor">#define NPF_DISABLE_LOOPBACK    1   </span>
<a name="l00236"></a><a class="code" href="group__NPF__include.html#g4a60d1f215d5b2af2b3b86a0f2a90ae2">00236</a> <span class="preprocessor">#define NPF_ENABLE_LOOPBACK     2   </span>
<a name="l00237"></a>00237 <span class="preprocessor"></span>
<a name="l00238"></a>00238 <span class="preprocessor"></span>
<a name="l00243"></a><a class="code" href="structpacket__file__header.html">00243</a> <span class="keyword">struct </span><a class="code" href="structpacket__file__header.html">packet_file_header</a> 
<a name="l00244"></a>00244 {
<a name="l00245"></a><a class="code" href="structpacket__file__header.html#b396ddef34e11edb49e5edfcc39c2dc7">00245</a>     UINT <a class="code" href="structpacket__file__header.html#b396ddef34e11edb49e5edfcc39c2dc7">magic</a>;             
<a name="l00246"></a><a class="code" href="structpacket__file__header.html#312dffcaa516df104318626fbdc01a77">00246</a>     USHORT <a class="code" href="structpacket__file__header.html#312dffcaa516df104318626fbdc01a77">version_major</a>;   
<a name="l00247"></a><a class="code" href="structpacket__file__header.html#143bc467378ffbd0460662bd8912082b">00247</a>     USHORT <a class="code" href="structpacket__file__header.html#143bc467378ffbd0460662bd8912082b">version_minor</a>;   
<a name="l00248"></a><a class="code" href="structpacket__file__header.html#b0f3e0ccc83861eb84cd3da32f01f090">00248</a>     UINT <a class="code" href="structpacket__file__header.html#b0f3e0ccc83861eb84cd3da32f01f090">thiszone</a>;          
<a name="l00249"></a><a class="code" href="structpacket__file__header.html#5938c470e9e548ad2ac04923725e7721">00249</a>     UINT <a class="code" href="structpacket__file__header.html#5938c470e9e548ad2ac04923725e7721">sigfigs</a>;           
<a name="l00250"></a><a class="code" href="structpacket__file__header.html#45b189420d67014dba25bd13da85ddae">00250</a>     UINT <a class="code" href="structpacket__file__header.html#45b189420d67014dba25bd13da85ddae">snaplen</a>;           
<a name="l00251"></a><a class="code" href="structpacket__file__header.html#b2a8854181cde7a065a43380b56fd2a1">00251</a>     UINT <a class="code" href="structpacket__file__header.html#b2a8854181cde7a065a43380b56fd2a1">linktype</a>;          
<a name="l00252"></a>00252 };
<a name="l00253"></a>00253 
<a name="l00258"></a><a class="code" href="structsf__pkthdr.html">00258</a> <span class="keyword">struct </span><a class="code" href="structsf__pkthdr.html">sf_pkthdr</a> {
<a name="l00259"></a><a class="code" href="structsf__pkthdr.html#21be78b2818c91cb205885b8a6f5aed8">00259</a>     <span class="keyword">struct </span>timeval  ts;         
<a name="l00260"></a><a class="code" href="structsf__pkthdr.html#ddde4bcd837b0ac2f4ab6472162c8ec2">00260</a>     UINT            <a class="code" href="structsf__pkthdr.html#ddde4bcd837b0ac2f4ab6472162c8ec2">caplen</a>;     
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 
<a name="l00263"></a><a class="code" href="structsf__pkthdr.html#acda8195c98d3cc32ebece7b17dac774">00263</a>     UINT            <a class="code" href="structsf__pkthdr.html#acda8195c98d3cc32ebece7b17dac774">len</a>;        
<a name="l00264"></a>00264 };
<a name="l00265"></a>00265 
<a name="l00275"></a><a class="code" href="struct__INTERNAL__REQUEST.html">00275</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__INTERNAL__REQUEST.html">_INTERNAL_REQUEST</a> {
<a name="l00276"></a><a class="code" href="struct__INTERNAL__REQUEST.html#52c50c47cc14f9989d741158ef6da1b9">00276</a>     LIST_ENTRY      <a class="code" href="struct__INTERNAL__REQUEST.html#52c50c47cc14f9989d741158ef6da1b9">ListElement</a>;        
<a name="l00277"></a>00277 <span class="comment">//    PIRP          Irp;                ///&lt; Irp that performed the request</span>
<a name="l00278"></a>00278 <span class="comment">//  BOOLEAN         Internal;           ///&lt; True if the request is for internal use of npf.sys. False if the request is performed by the user through an IOCTL.</span>
<a name="l00279"></a><a class="code" href="struct__INTERNAL__REQUEST.html#a27c26f410846e10408bc8ac558430b9">00279</a>     NDIS_EVENT      <a class="code" href="struct__INTERNAL__REQUEST.html#a27c26f410846e10408bc8ac558430b9">InternalRequestCompletedEvent</a>;
<a name="l00280"></a><a class="code" href="struct__INTERNAL__REQUEST.html#9d22abed5e537b5a86700c0cae0aeeda">00280</a>     NDIS_REQUEST    <a class="code" href="struct__INTERNAL__REQUEST.html#9d22abed5e537b5a86700c0cae0aeeda">Request</a>;            
<a name="l00281"></a><a class="code" href="struct__INTERNAL__REQUEST.html#1948690a3012c81acf392ba489b32b60">00281</a>     NDIS_STATUS     <a class="code" href="struct__INTERNAL__REQUEST.html#1948690a3012c81acf392ba489b32b60">RequestStatus</a>;
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 } <a class="code" href="struct__INTERNAL__REQUEST.html">INTERNAL_REQUEST</a>, *<a class="code" href="struct__INTERNAL__REQUEST.html">PINTERNAL_REQUEST</a>;
<a name="l00284"></a>00284 
<a name="l00292"></a><a class="code" href="struct__PACKET__RESERVED.html">00292</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__PACKET__RESERVED.html">_PACKET_RESERVED</a> {
<a name="l00293"></a><a class="code" href="struct__PACKET__RESERVED.html#52c50c47cc14f9989d741158ef6da1b9">00293</a>     LIST_ENTRY      <a class="code" href="struct__PACKET__RESERVED.html#52c50c47cc14f9989d741158ef6da1b9">ListElement</a>;        
<a name="l00294"></a><a class="code" href="struct__PACKET__RESERVED.html#4bee02d146b824008b9d03379b085b1e">00294</a>     PIRP            <a class="code" href="struct__PACKET__RESERVED.html#4bee02d146b824008b9d03379b085b1e">Irp</a>;                
<a name="l00295"></a><a class="code" href="struct__PACKET__RESERVED.html#3bbb67b64845622d97356325852ef6be">00295</a>     PMDL            <a class="code" href="struct__PACKET__RESERVED.html#3bbb67b64845622d97356325852ef6be">pMdl</a>;               
<a name="l00296"></a><a class="code" href="struct__PACKET__RESERVED.html#bc42eac7c5d3593aa809edceadb0743f">00296</a>     BOOLEAN         <a class="code" href="struct__PACKET__RESERVED.html#bc42eac7c5d3593aa809edceadb0743f">FreeBufAfterWrite</a>;  
<a name="l00297"></a>00297 
<a name="l00298"></a><a class="code" href="struct__PACKET__RESERVED.html#761baf004d76cf5faf3c898787fceeb6">00298</a>     ULONG           <a class="code" href="struct__PACKET__RESERVED.html#761baf004d76cf5faf3c898787fceeb6">Cpu</a>;                
<a name="l00299"></a>00299 }  <a class="code" href="struct__PACKET__RESERVED.html">PACKET_RESERVED</a>, *<a class="code" href="struct__PACKET__RESERVED.html">PPACKET_RESERVED</a>;
<a name="l00300"></a>00300 
<a name="l00301"></a><a class="code" href="group__NPF__include.html#g048ba8dfabc6ac16c602a1ca6fe994fc">00301</a> <span class="preprocessor">#define RESERVED(_p) ((PPACKET_RESERVED)((_p)-&gt;ProtocolReserved)) </span>
<a name="l00302"></a>00302 <span class="preprocessor"></span>
<a name="l00303"></a>00303 <span class="preprocessor"></span>
<a name="l00308"></a><a class="code" href="struct__DEVICE__EXTENSION.html">00308</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__DEVICE__EXTENSION.html">_DEVICE_EXTENSION</a> {
<a name="l00309"></a><a class="code" href="struct__DEVICE__EXTENSION.html#4ed31a6dde691df2159a6a407eefd4eb">00309</a>     NDIS_HANDLE    <a class="code" href="struct__DEVICE__EXTENSION.html#4ed31a6dde691df2159a6a407eefd4eb">NdisProtocolHandle</a>;  
<a name="l00310"></a><a class="code" href="struct__DEVICE__EXTENSION.html#8201dab43dd06ad55b93317cbbd54211">00310</a>     NDIS_STRING    <a class="code" href="struct__DEVICE__EXTENSION.html#8201dab43dd06ad55b93317cbbd54211">AdapterName</a>;         
<a name="l00311"></a><a class="code" href="struct__DEVICE__EXTENSION.html#147b6ff0677e88b5721e51ab7759121a">00311</a>     PWSTR          <a class="code" href="struct__DEVICE__EXTENSION.html#147b6ff0677e88b5721e51ab7759121a">ExportString</a>;        
<a name="l00312"></a>00312 
<a name="l00313"></a>00313 } <a class="code" href="struct__DEVICE__EXTENSION.html">DEVICE_EXTENSION</a>, *<a class="code" href="struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>;
<a name="l00314"></a>00314 
<a name="l00320"></a><a class="code" href="struct____CPU__Private__Data.html">00320</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct____CPU__Private__Data.html">__CPU_Private_Data</a>
<a name="l00321"></a>00321 {
<a name="l00322"></a><a class="code" href="struct____CPU__Private__Data.html#897d2179904e0d6fafd73b3d400052de">00322</a>     ULONG   <a class="code" href="struct____CPU__Private__Data.html#897d2179904e0d6fafd73b3d400052de">P</a>;                  
<a name="l00323"></a><a class="code" href="struct____CPU__Private__Data.html#2df61425b58c12f1de6f0e6aaeb131ea">00323</a>     ULONG   <a class="code" href="struct____CPU__Private__Data.html#2df61425b58c12f1de6f0e6aaeb131ea">C</a>;                  
<a name="l00324"></a><a class="code" href="struct____CPU__Private__Data.html#caf5ef1e959170b06d01fc65a27bb951">00324</a>     ULONG   <a class="code" href="struct____CPU__Private__Data.html#caf5ef1e959170b06d01fc65a27bb951">Free</a>;               
<a name="l00325"></a><a class="code" href="struct____CPU__Private__Data.html#7ed9f5e612c567cfa25af0f46a25dad4">00325</a>     PUCHAR  <a class="code" href="struct____CPU__Private__Data.html#7ed9f5e612c567cfa25af0f46a25dad4">Buffer</a>;             
<a name="l00326"></a><a class="code" href="struct____CPU__Private__Data.html#c723ebbda9ff2ef8e4d773c7305db1f6">00326</a>     ULONG   <a class="code" href="struct____CPU__Private__Data.html#c723ebbda9ff2ef8e4d773c7305db1f6">Accepted</a>;           
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 
<a name="l00329"></a>00329 
<a name="l00330"></a><a class="code" href="struct____CPU__Private__Data.html#82febc79f3f3bbf857a4fd34447b5ca2">00330</a>     ULONG   <a class="code" href="struct____CPU__Private__Data.html#82febc79f3f3bbf857a4fd34447b5ca2">Received</a>;           
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 
<a name="l00333"></a>00333 
<a name="l00334"></a><a class="code" href="struct____CPU__Private__Data.html#04eecb86252e644a73f38346274340dc">00334</a>     ULONG   <a class="code" href="struct____CPU__Private__Data.html#04eecb86252e644a73f38346274340dc">Dropped</a>;            
<a name="l00335"></a>00335 
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 
<a name="l00338"></a><a class="code" href="struct____CPU__Private__Data.html#59c9030d87b24c9cb4efdabe9c7b9337">00338</a>     NDIS_SPIN_LOCK <a class="code" href="struct____CPU__Private__Data.html#59c9030d87b24c9cb4efdabe9c7b9337">BufferLock</a>;  
<a name="l00339"></a><a class="code" href="struct____CPU__Private__Data.html#cae03ade5065032ceaeef0bd03217b4f">00339</a>     PMDL    <a class="code" href="struct____CPU__Private__Data.html#cae03ade5065032ceaeef0bd03217b4f">TransferMdl1</a>;       
<a name="l00340"></a><a class="code" href="struct____CPU__Private__Data.html#17b59e156d00ef5c76bdfe454c73ca49">00340</a>     PMDL    <a class="code" href="struct____CPU__Private__Data.html#17b59e156d00ef5c76bdfe454c73ca49">TransferMdl2</a>;       
<a name="l00341"></a><a class="code" href="struct____CPU__Private__Data.html#58f2c915dfc7041ccb0d568eb79b494e">00341</a>     ULONG   <a class="code" href="struct____CPU__Private__Data.html#58f2c915dfc7041ccb0d568eb79b494e">NewP</a>;               
<a name="l00342"></a>00342 }
<a name="l00343"></a>00343     <a class="code" href="struct____CPU__Private__Data.html">CpuPrivateData</a>;
<a name="l00344"></a>00344 
<a name="l00345"></a>00345 
<a name="l00353"></a><a class="code" href="struct__OPEN__INSTANCE.html">00353</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__OPEN__INSTANCE.html">_OPEN_INSTANCE</a>
<a name="l00354"></a>00354 {
<a name="l00355"></a><a class="code" href="struct__OPEN__INSTANCE.html#aa72c26b5a1b98197da412302325e009">00355</a>     <a class="code" href="group__NPF__include.html#gc8ad25578be589c8352fc4e1a8a99be3">PDEVICE_EXTENSION</a>   <a class="code" href="struct__OPEN__INSTANCE.html#aa72c26b5a1b98197da412302325e009">DeviceExtension</a>;    
<a name="l00356"></a>00356 
<a name="l00357"></a><a class="code" href="struct__OPEN__INSTANCE.html#a017f65671fb96e4a0d3e875536579df">00357</a>     NDIS_HANDLE         <a class="code" href="struct__OPEN__INSTANCE.html#a017f65671fb96e4a0d3e875536579df">AdapterHandle</a>;      
<a name="l00358"></a><a class="code" href="struct__OPEN__INSTANCE.html#f6a81c046e634d6149550d3475924c05">00358</a>     UINT                <a class="code" href="struct__OPEN__INSTANCE.html#f6a81c046e634d6149550d3475924c05">Medium</a>;             
<a name="l00359"></a>00359 
<a name="l00360"></a><a class="code" href="struct__OPEN__INSTANCE.html#bb035c7e10216edcf41fa1576fecca42">00360</a>     NDIS_HANDLE         <a class="code" href="struct__OPEN__INSTANCE.html#bb035c7e10216edcf41fa1576fecca42">PacketPool</a>;         
<a name="l00361"></a><a class="code" href="struct__OPEN__INSTANCE.html#be53f2762ef5451c80b2fcadeff59884">00361</a>     KSPIN_LOCK          <a class="code" href="struct__OPEN__INSTANCE.html#be53f2762ef5451c80b2fcadeff59884">RequestSpinLock</a>;    
<a name="l00362"></a><a class="code" href="struct__OPEN__INSTANCE.html#805c530d7fa5f6078b9170dc0cd03f5c">00362</a>     LIST_ENTRY          <a class="code" href="struct__OPEN__INSTANCE.html#805c530d7fa5f6078b9170dc0cd03f5c">RequestList</a>;        
<a name="l00363"></a><a class="code" href="struct__OPEN__INSTANCE.html#1836c9a11084bf113d902946c5c41499">00363</a>     LIST_ENTRY          <a class="code" href="struct__OPEN__INSTANCE.html#1836c9a11084bf113d902946c5c41499">ResetIrpList</a>;       
<a name="l00364"></a><a class="code" href="struct__OPEN__INSTANCE.html#9a6854a154d332159dbcb19e5d104441">00364</a>     <a class="code" href="struct__INTERNAL__REQUEST.html">INTERNAL_REQUEST</a>    <a class="code" href="struct__OPEN__INSTANCE.html#9a6854a154d332159dbcb19e5d104441">Requests</a>[<a class="code" href="group__NPF__include.html#g8fc96cee4177a369a99de7026ebeba81">MAX_REQUESTS</a>]; 
<a name="l00365"></a><a class="code" href="struct__OPEN__INSTANCE.html#006227bc7ca0b2df920a8adfb7740ecb">00365</a>     PMDL                <a class="code" href="struct__OPEN__INSTANCE.html#006227bc7ca0b2df920a8adfb7740ecb">BufferMdl</a>;          
<a name="l00366"></a><a class="code" href="struct__OPEN__INSTANCE.html#6139735ab3e4fa797d344e314bba6473">00366</a>     PKEVENT             <a class="code" href="struct__OPEN__INSTANCE.html#6139735ab3e4fa797d344e314bba6473">ReadEvent</a>;          
<a name="l00367"></a><a class="code" href="struct__OPEN__INSTANCE.html#312a1a6ffddf98f960cd0ac2d56fce52">00367</a>     PUCHAR              <a class="code" href="struct__OPEN__INSTANCE.html#312a1a6ffddf98f960cd0ac2d56fce52">bpfprogram</a>;         
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="preprocessor">#ifdef __NPF_x86__</span>
<a name="l00373"></a>00373 <span class="preprocessor"></span>    <a class="code" href="structJIT__BPF__Filter.html">JIT_BPF_Filter</a>      *Filter;            
<a name="l00374"></a>00374 
<a name="l00375"></a>00375 <span class="preprocessor">#endif</span>
<a name="l00376"></a><a class="code" href="struct__OPEN__INSTANCE.html#263f7d6f5db5625541d275380685f0b1">00376</a> <span class="preprocessor"></span>    UINT                <a class="code" href="struct__OPEN__INSTANCE.html#263f7d6f5db5625541d275380685f0b1">MinToCopy</a>;          
<a name="l00377"></a>00377 
<a name="l00378"></a><a class="code" href="struct__OPEN__INSTANCE.html#a6709070de8443c026e3b86913942c2b">00378</a>     LARGE_INTEGER       <a class="code" href="struct__OPEN__INSTANCE.html#a6709070de8443c026e3b86913942c2b">TimeOut</a>;            
<a name="l00379"></a>00379 
<a name="l00380"></a>00380                                             
<a name="l00381"></a><a class="code" href="struct__OPEN__INSTANCE.html#1ea5d0cb93f22f7d0fdf804bd68c3326">00381</a>     <span class="keywordtype">int</span>                 <a class="code" href="struct__OPEN__INSTANCE.html#1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a>;               
<a name="l00382"></a><a class="code" href="struct__OPEN__INSTANCE.html#87b5968c02200b033f7c6e15da439e62">00382</a>     LARGE_INTEGER       <a class="code" href="struct__OPEN__INSTANCE.html#87b5968c02200b033f7c6e15da439e62">Nbytes</a>;             
<a name="l00383"></a><a class="code" href="struct__OPEN__INSTANCE.html#51a42386327e2a337854dd20cbe83061">00383</a>     LARGE_INTEGER       <a class="code" href="struct__OPEN__INSTANCE.html#51a42386327e2a337854dd20cbe83061">Npackets</a>;           
<a name="l00384"></a><a class="code" href="struct__OPEN__INSTANCE.html#7bd68a3950090232f1147e501a4ccf78">00384</a>     NDIS_SPIN_LOCK      <a class="code" href="struct__OPEN__INSTANCE.html#7bd68a3950090232f1147e501a4ccf78">CountersLock</a>;       
<a name="l00385"></a><a class="code" href="struct__OPEN__INSTANCE.html#f6b5b0a348f7a40d795b554b0eceed73">00385</a>     UINT                <a class="code" href="struct__OPEN__INSTANCE.html#f6b5b0a348f7a40d795b554b0eceed73">Nwrites</a>;            
<a name="l00386"></a>00386 
<a name="l00387"></a><a class="code" href="struct__OPEN__INSTANCE.html#aa76c3b87b73baaa785c459188d769e0">00387</a>     ULONG               <a class="code" href="struct__OPEN__INSTANCE.html#aa76c3b87b73baaa785c459188d769e0">Multiple_Write_Counter</a>; 
<a name="l00388"></a><a class="code" href="struct__OPEN__INSTANCE.html#46f6423b318291c7cc6ae32c226b33fd">00388</a>     NDIS_EVENT          <a class="code" href="struct__OPEN__INSTANCE.html#46f6423b318291c7cc6ae32c226b33fd">WriteEvent</a>;         
<a name="l00389"></a><a class="code" href="struct__OPEN__INSTANCE.html#f854d4eefa0f15302eaccee06e1ef447">00389</a>     BOOLEAN             <a class="code" href="struct__OPEN__INSTANCE.html#f854d4eefa0f15302eaccee06e1ef447">WriteInProgress</a>;    
<a name="l00390"></a>00390 
<a name="l00391"></a><a class="code" href="struct__OPEN__INSTANCE.html#44ab7ba650b09972a0677958ad0ea4e0">00391</a>     NDIS_SPIN_LOCK      <a class="code" href="struct__OPEN__INSTANCE.html#44ab7ba650b09972a0677958ad0ea4e0">WriteLock</a>;          
<a name="l00392"></a><a class="code" href="struct__OPEN__INSTANCE.html#f63559424b5849687cc5c5fbad184c0f">00392</a>     NDIS_EVENT          <a class="code" href="struct__OPEN__INSTANCE.html#f63559424b5849687cc5c5fbad184c0f">NdisRequestEvent</a>;   
<a name="l00393"></a><a class="code" href="struct__OPEN__INSTANCE.html#445a6029d067430cd761ae692443b573">00393</a>     BOOLEAN             <a class="code" href="struct__OPEN__INSTANCE.html#445a6029d067430cd761ae692443b573">SkipSentPackets</a>;    
<a name="l00394"></a><a class="code" href="struct__OPEN__INSTANCE.html#f4f46bc8ed07a40605aeac6743a3e760">00394</a>     NDIS_STATUS         <a class="code" href="struct__OPEN__INSTANCE.html#f4f46bc8ed07a40605aeac6743a3e760">IOStatus</a>;           
<a name="l00395"></a><a class="code" href="struct__OPEN__INSTANCE.html#ffef27f71b541e5dfab6a3dc9ea7dd86">00395</a>     HANDLE              <a class="code" href="struct__OPEN__INSTANCE.html#ffef27f71b541e5dfab6a3dc9ea7dd86">DumpFileHandle</a>;     
<a name="l00396"></a><a class="code" href="struct__OPEN__INSTANCE.html#093d2624638004aafcc3193328cf2626">00396</a>     PFILE_OBJECT        <a class="code" href="struct__OPEN__INSTANCE.html#093d2624638004aafcc3193328cf2626">DumpFileObject</a>;     
<a name="l00397"></a><a class="code" href="struct__OPEN__INSTANCE.html#f5fc8480398782ff1f676f25f5097768">00397</a>     PKTHREAD            <a class="code" href="struct__OPEN__INSTANCE.html#f5fc8480398782ff1f676f25f5097768">DumpThreadObject</a>;   
<a name="l00398"></a><a class="code" href="struct__OPEN__INSTANCE.html#fb4bb3d6e021e9b1cc1206fa23d4c8f7">00398</a>     HANDLE              <a class="code" href="struct__OPEN__INSTANCE.html#fb4bb3d6e021e9b1cc1206fa23d4c8f7">DumpThreadHandle</a>;   
<a name="l00399"></a><a class="code" href="struct__OPEN__INSTANCE.html#1485cbdca5f70ed6a4eb8fd26feec1e0">00399</a>     NDIS_EVENT          <a class="code" href="struct__OPEN__INSTANCE.html#1485cbdca5f70ed6a4eb8fd26feec1e0">DumpEvent</a>;          
<a name="l00400"></a><a class="code" href="struct__OPEN__INSTANCE.html#00c3ae6811320e03dea5b400fc5f9da8">00400</a>     LARGE_INTEGER       <a class="code" href="struct__OPEN__INSTANCE.html#00c3ae6811320e03dea5b400fc5f9da8">DumpOffset</a>;         
<a name="l00401"></a><a class="code" href="struct__OPEN__INSTANCE.html#d26771cfc74dde2d2ce22b38db3124b0">00401</a>     UNICODE_STRING      <a class="code" href="struct__OPEN__INSTANCE.html#d26771cfc74dde2d2ce22b38db3124b0">DumpFileName</a>;       
<a name="l00402"></a><a class="code" href="struct__OPEN__INSTANCE.html#cfde736fb2a011607da168a05b5100b0">00402</a>     UINT                <a class="code" href="struct__OPEN__INSTANCE.html#cfde736fb2a011607da168a05b5100b0">MaxDumpBytes</a>;       
<a name="l00403"></a>00403 
<a name="l00404"></a><a class="code" href="struct__OPEN__INSTANCE.html#3f6accd17a8dccf9b44acc678510a094">00404</a>     UINT                <a class="code" href="struct__OPEN__INSTANCE.html#3f6accd17a8dccf9b44acc678510a094">MaxDumpPacks</a>;       
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 
<a name="l00407"></a><a class="code" href="struct__OPEN__INSTANCE.html#612913cea459725cff2085d29e534aae">00407</a>     BOOLEAN             <a class="code" href="struct__OPEN__INSTANCE.html#612913cea459725cff2085d29e534aae">DumpLimitReached</a>;   
<a name="l00408"></a>00408 
<a name="l00409"></a><a class="code" href="struct__OPEN__INSTANCE.html#1d418ff912e4cc60edc5268b0b6f69f8">00409</a>     MEM_TYPE            <a class="code" href="struct__OPEN__INSTANCE.html#1d418ff912e4cc60edc5268b0b6f69f8">mem_ex</a>;             
<a name="l00410"></a><a class="code" href="struct__OPEN__INSTANCE.html#86df193682856002932a6d0eda0db003">00410</a>     TME_CORE            <a class="code" href="struct__OPEN__INSTANCE.html#86df193682856002932a6d0eda0db003">tme</a>;                
<a name="l00411"></a><a class="code" href="struct__OPEN__INSTANCE.html#fe174f20f512159a454365613846eca5">00411</a>     NDIS_SPIN_LOCK      <a class="code" href="struct__OPEN__INSTANCE.html#fe174f20f512159a454365613846eca5">MachineLock</a>;        
<a name="l00412"></a><a class="code" href="struct__OPEN__INSTANCE.html#c672771358770d24087aaa12a80d01cb">00412</a>     UINT                <a class="code" href="struct__OPEN__INSTANCE.html#c672771358770d24087aaa12a80d01cb">MaxFrameSize</a>;       
<a name="l00413"></a>00413 
<a name="l00414"></a><a class="code" href="struct__OPEN__INSTANCE.html#3ac423f755c4e1121951ae44292d6aab">00414</a>     <a class="code" href="struct____CPU__Private__Data.html">CpuPrivateData</a>      <a class="code" href="struct__OPEN__INSTANCE.html#3ac423f755c4e1121951ae44292d6aab">CpuData</a>[32];        
<a name="l00415"></a><a class="code" href="struct__OPEN__INSTANCE.html#80fd41275e80049cbe8238917a1dfb33">00415</a>     ULONG               <a class="code" href="struct__OPEN__INSTANCE.html#80fd41275e80049cbe8238917a1dfb33">ReaderSN</a>;           
<a name="l00416"></a><a class="code" href="struct__OPEN__INSTANCE.html#e58565fec941091aa7164b49121ffe2b">00416</a>     ULONG               <a class="code" href="struct__OPEN__INSTANCE.html#e58565fec941091aa7164b49121ffe2b">WriterSN</a>;           
<a name="l00417"></a>00417 
<a name="l00418"></a><a class="code" href="struct__OPEN__INSTANCE.html#1ce5ea4c97c82145e50d4b5157889a0e">00418</a>     ULONG               <a class="code" href="struct__OPEN__INSTANCE.html#1ce5ea4c97c82145e50d4b5157889a0e">Size</a>;               
<a name="l00419"></a><a class="code" href="struct__OPEN__INSTANCE.html#7157ac074af79faeddb2feef7a891af7">00419</a>     ULONG              <a class="code" href="struct__OPEN__INSTANCE.html#7157ac074af79faeddb2feef7a891af7">AdapterHandleUsageCounter</a>;
<a name="l00420"></a><a class="code" href="struct__OPEN__INSTANCE.html#dbc32cf0b83107c2ad2785b8c71a946b">00420</a>     NDIS_SPIN_LOCK     <a class="code" href="struct__OPEN__INSTANCE.html#dbc32cf0b83107c2ad2785b8c71a946b">AdapterHandleLock</a>;
<a name="l00421"></a><a class="code" href="struct__OPEN__INSTANCE.html#a8dd1c538f9932a866ac342d50277929">00421</a>     ULONG              <a class="code" href="struct__OPEN__INSTANCE.html#a8dd1c538f9932a866ac342d50277929">AdapterBindingStatus</a>;    
<a name="l00422"></a>00422 
<a name="l00423"></a><a class="code" href="struct__OPEN__INSTANCE.html#58faf70e2b245f7d3f2b1a90257e823e">00423</a>     NDIS_EVENT         <a class="code" href="struct__OPEN__INSTANCE.html#58faf70e2b245f7d3f2b1a90257e823e">NdisOpenCloseCompleteEvent</a>;
<a name="l00424"></a><a class="code" href="struct__OPEN__INSTANCE.html#e16d8f96321924cea79edfba9a2aed9f">00424</a>     NDIS_EVENT         <a class="code" href="struct__OPEN__INSTANCE.html#e16d8f96321924cea79edfba9a2aed9f">NdisWriteCompleteEvent</a>;  
<a name="l00425"></a><a class="code" href="struct__OPEN__INSTANCE.html#e3c547ec9f715618b461b221fa2e3f09">00425</a>     NTSTATUS           <a class="code" href="struct__OPEN__INSTANCE.html#e3c547ec9f715618b461b221fa2e3f09">OpenCloseStatus</a>;
<a name="l00426"></a><a class="code" href="struct__OPEN__INSTANCE.html#3134a9bd6b67acf8eb8f5fd7a36228d7">00426</a>     ULONG              <a class="code" href="struct__OPEN__INSTANCE.html#3134a9bd6b67acf8eb8f5fd7a36228d7">TransmitPendingPackets</a>;  
<a name="l00427"></a>00427 }
<a name="l00428"></a>00428 <a class="code" href="struct__OPEN__INSTANCE.html">OPEN_INSTANCE</a>, *<a class="code" href="struct__OPEN__INSTANCE.html">POPEN_INSTANCE</a>;
<a name="l00429"></a>00429 
<a name="l00430"></a><a class="code" href="group__NPF__include.html#ga80226df1c5ee18b01580d23ed4f31cb">00430</a> <span class="keyword">enum</span> <a class="code" href="group__NPF__include.html#ga80226df1c5ee18b01580d23ed4f31cb">ADAPTER_BINDING_STATUS</a>
<a name="l00431"></a>00431 {
<a name="l00432"></a>00432     <a class="code" href="group__NPF__include.html#gga80226df1c5ee18b01580d23ed4f31cb6e4cdf9f09abf447cffdfd5058357822">ADAPTER_UNBOUND</a>,
<a name="l00433"></a>00433     <a class="code" href="group__NPF__include.html#gga80226df1c5ee18b01580d23ed4f31cb3e0c0f314d2e9dc41c205ab44bf087bc">ADAPTER_BOUND</a>,
<a name="l00434"></a>00434     <a class="code" href="group__NPF__include.html#gga80226df1c5ee18b01580d23ed4f31cbdc92e852ef35fac0f033487a3be66a93">ADAPTER_UNBINDING</a>,
<a name="l00435"></a>00435 };
<a name="l00436"></a>00436 
<a name="l00444"></a><a class="code" href="structPacketHeader.html">00444</a> <span class="keyword">struct </span><a class="code" href="structPacketHeader.html">PacketHeader</a>
<a name="l00445"></a>00445 {
<a name="l00446"></a><a class="code" href="structPacketHeader.html#fbd4efa90a98223b9ebe18574c057b47">00446</a>     ULONG <a class="code" href="structPacketHeader.html#fbd4efa90a98223b9ebe18574c057b47">SN</a>;                               
<a name="l00447"></a><a class="code" href="structPacketHeader.html#e2f3ed1162db1cfdbd9abe8f203426ad">00447</a>     <span class="keyword">struct </span>bpf_hdr header;                  
<a name="l00448"></a>00448 };
<a name="l00449"></a>00449 
<a name="l00450"></a>00450 <span class="keyword">extern</span> ULONG <a class="code" href="group__NPF__include.html#gc8b70ca3f1feebb1ba40c85e3f852eb7">NCpu</a>;
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 
<a name="l00453"></a><a class="code" href="group__NPF__include.html#g652e6173ee1441712652d74a5533e042">00453</a> <span class="preprocessor">#define TRANSMIT_PACKETS 256    </span>
<a name="l00454"></a>00454 <span class="preprocessor"></span>
<a name="l00455"></a>00455 <span class="preprocessor"></span>
<a name="l00456"></a>00456 <span class="preprocessor"></span>
<a name="l00458"></a><a class="code" href="group__NPF__include.html#gcabf25322566f3bcd1e564e4939f5821">00458</a> <span class="preprocessor">#define EXIT_SUCCESS(quantity) Irp-&gt;IoStatus.Information=quantity;\</span>
<a name="l00459"></a>00459 <span class="preprocessor">    Irp-&gt;IoStatus.Status = STATUS_SUCCESS;\</span>
<a name="l00460"></a>00460 <span class="preprocessor">    IoCompleteRequest(Irp, IO_NO_INCREMENT);\</span>
<a name="l00461"></a>00461 <span class="preprocessor">    return STATUS_SUCCESS;\</span>
<a name="l00462"></a>00462 <span class="preprocessor"></span>
<a name="l00464"></a><a class="code" href="group__NPF__include.html#gd6d1f5522a147ddeb7d9b11916acd50a">00464</a> <span class="preprocessor">#define EXIT_FAILURE(quantity) Irp-&gt;IoStatus.Information=quantity;\</span>
<a name="l00465"></a>00465 <span class="preprocessor">    Irp-&gt;IoStatus.Status = STATUS_UNSUCCESSFUL;\</span>
<a name="l00466"></a>00466 <span class="preprocessor">    IoCompleteRequest(Irp, IO_NO_INCREMENT);\</span>
<a name="l00467"></a>00467 <span class="preprocessor">    return STATUS_UNSUCCESSFUL;\</span>
<a name="l00468"></a>00468 <span class="preprocessor"></span>
<a name="l00469"></a>00469 <span class="preprocessor"></span>
<a name="l00474"></a>00474 <span class="comment">/***************************/</span>
<a name="l00475"></a>00475 <span class="comment">/*       Prototypes        */</span>
<a name="l00476"></a>00476 <span class="comment">/***************************/</span>
<a name="l00477"></a>00477 
<a name="l00494"></a>00494 NTSTATUS
<a name="l00495"></a>00495 <a class="code" href="group__NPF__code.html#g6502d781bd20234a06710b92d540baba">DriverEntry</a>(
<a name="l00496"></a>00496     IN PDRIVER_OBJECT DriverObject,
<a name="l00497"></a>00497     IN PUNICODE_STRING RegistryPath
<a name="l00498"></a>00498     );
<a name="l00499"></a>00499 
<a name="l00509"></a>00509 PWCHAR <a class="code" href="group__NPF__code.html#gfc395636686df00f554efbd2010f73cb">getAdaptersList</a>(VOID);
<a name="l00510"></a>00510 
<a name="l00517"></a>00517 PKEY_VALUE_PARTIAL_INFORMATION <a class="code" href="group__NPF__code.html#gcf0e32b371eb9283e5cf1de0dfb15629">getTcpBindings</a>(VOID);
<a name="l00518"></a>00518 
<a name="l00530"></a>00530 BOOLEAN <a class="code" href="group__NPF__code.html#g8b4f23818c00c1186aa0bc59b57ff6c6">createDevice</a>(
<a name="l00531"></a>00531     IN OUT PDRIVER_OBJECT adriverObjectP,
<a name="l00532"></a>00532     IN PUNICODE_STRING amacNameP,
<a name="l00533"></a>00533     NDIS_HANDLE aProtoHandle);
<a name="l00534"></a>00534 
<a name="l00546"></a>00546 NTSTATUS
<a name="l00547"></a>00547 <a class="code" href="group__NPF__code.html#g82e557625e52fe4395bbe2e494fe8c4a">NPF_Open</a>(
<a name="l00548"></a>00548     IN PDEVICE_OBJECT DeviceObject,
<a name="l00549"></a>00549     IN PIRP Irp
<a name="l00550"></a>00550     );
<a name="l00551"></a>00551 
<a name="l00561"></a>00561 VOID
<a name="l00562"></a>00562 <a class="code" href="group__NPF__code.html#g155ae51be29c6d36f8109781b8f6e7b2">NPF_OpenAdapterComplete</a>(
<a name="l00563"></a>00563     IN NDIS_HANDLE  ProtocolBindingContext,
<a name="l00564"></a>00564     IN NDIS_STATUS  Status,
<a name="l00565"></a>00565     IN NDIS_STATUS  OpenErrorStatus
<a name="l00566"></a>00566     );
<a name="l00567"></a>00567 
<a name="l00578"></a>00578 NTSTATUS
<a name="l00579"></a>00579 <a class="code" href="group__NPF__code.html#gfae94a0e7fda8de180cff6e596cc2803">NPF_Cleanup</a>(
<a name="l00580"></a>00580     IN PDEVICE_OBJECT DeviceObject,
<a name="l00581"></a>00581     IN PIRP Irp
<a name="l00582"></a>00582     );
<a name="l00583"></a>00583 
<a name="l00584"></a>00584 NTSTATUS
<a name="l00585"></a>00585 <a class="code" href="group__NPF__code.html#gf8b70be389645c912cf09f1e9ea4b975">NPF_Close</a>(
<a name="l00586"></a>00586     IN PDEVICE_OBJECT DeviceObject,
<a name="l00587"></a>00587     IN PIRP Irp
<a name="l00588"></a>00588     );
<a name="l00589"></a>00589 
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 
<a name="l00600"></a>00600 VOID
<a name="l00601"></a>00601 <a class="code" href="group__NPF__code.html#g300118a9a6cc28c2c880f6bb39d86b53">NPF_CloseAdapterComplete</a>(
<a name="l00602"></a>00602     IN NDIS_HANDLE  ProtocolBindingContext,
<a name="l00603"></a>00603     IN NDIS_STATUS  Status
<a name="l00604"></a>00604     );
<a name="l00605"></a>00605 
<a name="l00628"></a>00628 NDIS_STATUS
<a name="l00629"></a>00629 <a class="code" href="group__NPF__code.html#g92f84ced372baf09f1c00a6b252a0564">NPF_tap</a>(
<a name="l00630"></a>00630     IN NDIS_HANDLE ProtocolBindingContext,
<a name="l00631"></a>00631     IN NDIS_HANDLE MacReceiveContext,
<a name="l00632"></a>00632     IN PVOID HeaderBuffer,
<a name="l00633"></a>00633     IN UINT HeaderBufferSize,
<a name="l00634"></a>00634     IN PVOID LookAheadBuffer,
<a name="l00635"></a>00635     IN UINT LookaheadBufferSize,
<a name="l00636"></a>00636     IN UINT PacketSize
<a name="l00637"></a>00637     );
<a name="l00638"></a>00638 
<a name="l00649"></a>00649 VOID
<a name="l00650"></a>00650 <a class="code" href="group__NPF__code.html#g0c34f931d6718be202c7c62406f279fd">NPF_TransferDataComplete</a>(
<a name="l00651"></a>00651     IN NDIS_HANDLE ProtocolBindingContext,
<a name="l00652"></a>00652     IN PNDIS_PACKET Packet,
<a name="l00653"></a>00653     IN NDIS_STATUS Status,
<a name="l00654"></a>00654     IN UINT BytesTransferred
<a name="l00655"></a>00655     );
<a name="l00656"></a>00656 
<a name="l00663"></a>00663 VOID
<a name="l00664"></a>00664 <a class="code" href="group__NPF__code.html#ge7863db01a628ed11324c49953195855">NPF_ReceiveComplete</a>(IN NDIS_HANDLE  ProtocolBindingContext);
<a name="l00665"></a>00665 
<a name="l00689"></a>00689 NTSTATUS
<a name="l00690"></a>00690 <a class="code" href="group__NPF__code.html#gd8b208720b6e5149dabcd7fb058b16f7">NPF_IoControl</a>(
<a name="l00691"></a>00691     IN PDEVICE_OBJECT DeviceObject,
<a name="l00692"></a>00692     IN PIRP Irp
<a name="l00693"></a>00693     );
<a name="l00694"></a>00694 
<a name="l00695"></a>00695 VOID
<a name="l00696"></a>00696 
<a name="l00706"></a>00706 <a class="code" href="group__NPF__code.html#g4ff37c0fd3273f829a1f84b9ab40755b">NPF_RequestComplete</a>(
<a name="l00707"></a>00707     IN NDIS_HANDLE   ProtocolBindingContext,
<a name="l00708"></a>00708     IN PNDIS_REQUEST pRequest,
<a name="l00709"></a>00709     IN NDIS_STATUS   Status
<a name="l00710"></a>00710     );
<a name="l00711"></a>00711 
<a name="l00724"></a>00724 NTSTATUS
<a name="l00725"></a>00725 <a class="code" href="group__NPF__code.html#g595338435296a4d1e15363ebfcb3a38c">NPF_Write</a>(
<a name="l00726"></a>00726             IN PDEVICE_OBJECT DeviceObject,
<a name="l00727"></a>00727             IN PIRP Irp
<a name="l00728"></a>00728             );
<a name="l00729"></a>00729 
<a name="l00730"></a>00730 
<a name="l00750"></a>00750 INT <a class="code" href="group__NPF__code.html#g9a97dd25ae757da4bfed3723a4eb4bce">NPF_BufferedWrite</a>(IN PIRP Irp, 
<a name="l00751"></a>00751                         IN PCHAR UserBuff, 
<a name="l00752"></a>00752                         IN ULONG UserBuffSize,
<a name="l00753"></a>00753                         BOOLEAN sync);
<a name="l00754"></a>00754 
<a name="l00762"></a>00762 VOID <a class="code" href="group__NPF__code.html#g8861b474efcb6578c9fe2075ff3e6aef">NPF_WaitEndOfBufferedWrite</a>(<a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> Open);
<a name="l00763"></a>00763 
<a name="l00773"></a>00773 VOID
<a name="l00774"></a>00774 <a class="code" href="group__NPF__code.html#ged126572458eed2dcd18d1824ac86601">NPF_SendComplete</a>(
<a name="l00775"></a>00775     IN NDIS_HANDLE   ProtocolBindingContext,
<a name="l00776"></a>00776     IN PNDIS_PACKET  pPacket,
<a name="l00777"></a>00777     IN NDIS_STATUS   Status
<a name="l00778"></a>00778     );
<a name="l00779"></a>00779 
<a name="l00789"></a>00789 VOID
<a name="l00790"></a>00790 <a class="code" href="group__NPF__code.html#g4e7934d9adb1826ed5e9112b9182f74a">NPF_ResetComplete</a>(
<a name="l00791"></a>00791     IN NDIS_HANDLE  ProtocolBindingContext,
<a name="l00792"></a>00792     IN NDIS_STATUS  Status
<a name="l00793"></a>00793     );
<a name="l00794"></a>00794 
<a name="l00798"></a>00798 VOID
<a name="l00799"></a>00799 <a class="code" href="group__NPF__code.html#g1a8cf4fdeed6e93fcf1f50da654402b7">NPF_Status</a>(
<a name="l00800"></a>00800     IN NDIS_HANDLE   ProtocolBindingContext,
<a name="l00801"></a>00801     IN NDIS_STATUS   Status,
<a name="l00802"></a>00802     IN PVOID         StatusBuffer,
<a name="l00803"></a>00803     IN UINT          StatusBufferSize
<a name="l00804"></a>00804     );
<a name="l00805"></a>00805 
<a name="l00806"></a>00806 
<a name="l00810"></a>00810 VOID
<a name="l00811"></a>00811 <a class="code" href="group__NPF__code.html#g70f97109adcd6de8b157534e5ecf2e56">NPF_StatusComplete</a>(IN NDIS_HANDLE  ProtocolBindingContext);
<a name="l00812"></a>00812 
<a name="l00821"></a>00821 VOID
<a name="l00822"></a>00822 <a class="code" href="group__NPF__code.html#g5eb5a8e754198d1bbc6572cbc9e59b9c">NPF_Unload</a>(IN PDRIVER_OBJECT DriverObject);
<a name="l00823"></a>00823 
<a name="l00824"></a>00824 
<a name="l00843"></a>00843 NTSTATUS
<a name="l00844"></a>00844 <a class="code" href="group__NPF__code.html#g827b1433b2d08cbac11b3844d721668f">NPF_Read</a>(
<a name="l00845"></a>00845     IN PDEVICE_OBJECT DeviceObject,
<a name="l00846"></a>00846     IN PIRP Irp
<a name="l00847"></a>00847     );
<a name="l00848"></a>00848 
<a name="l00854"></a>00854 NTSTATUS
<a name="l00855"></a>00855 <a class="code" href="group__NPF__code.html#g1a3ce25625792c74e5792b8fa86a489c">NPF_ReadRegistry</a>(
<a name="l00856"></a>00856     IN  PWSTR              *MacDriverName,
<a name="l00857"></a>00857     IN  PWSTR              *PacketDriverName,
<a name="l00858"></a>00858     IN  PUNICODE_STRING     RegistryPath
<a name="l00859"></a>00859     );
<a name="l00860"></a>00860 
<a name="l00867"></a>00867 NTSTATUS
<a name="l00868"></a>00868 <a class="code" href="group__NPF__code.html#g8831b54dcd5361e81ddf0d3165f1fb8f">NPF_QueryRegistryRoutine</a>(
<a name="l00869"></a>00869     IN PWSTR     ValueName,
<a name="l00870"></a>00870     IN ULONG     ValueType,
<a name="l00871"></a>00871     IN PVOID     ValueData,
<a name="l00872"></a>00872     IN ULONG     ValueLength,
<a name="l00873"></a>00873     IN PVOID     Context,
<a name="l00874"></a>00874     IN PVOID     EntryContext
<a name="l00875"></a>00875     );
<a name="l00876"></a>00876 
<a name="l00882"></a>00882 VOID <a class="code" href="group__NPF__code.html#g9a78f9937b2d7d00250f49dcaeb5bab0">NPF_BindAdapter</a>(
<a name="l00883"></a>00883     OUT PNDIS_STATUS            Status,
<a name="l00884"></a>00884     IN  NDIS_HANDLE             BindContext,
<a name="l00885"></a>00885     IN  PNDIS_STRING            DeviceName,
<a name="l00886"></a>00886     IN  PVOID                   SystemSpecific1,
<a name="l00887"></a>00887     IN  PVOID                   SystemSpecific2
<a name="l00888"></a>00888     );
<a name="l00889"></a>00889 
<a name="l00901"></a>00901 VOID
<a name="l00902"></a>00902 <a class="code" href="group__NPF__code.html#g54d94e883ff4c580289eefaf0d1fc356">NPF_UnbindAdapter</a>(
<a name="l00903"></a>00903     OUT PNDIS_STATUS        Status,
<a name="l00904"></a>00904     IN  NDIS_HANDLE         ProtocolBindingContext,
<a name="l00905"></a>00905     IN  NDIS_HANDLE         UnbindContext
<a name="l00906"></a>00906     );
<a name="l00907"></a>00907 
<a name="l00908"></a>00908 
<a name="l00916"></a>00916 NTSTATUS <a class="code" href="group__NPF__code.html#ge3d1118c72b474fe214517a65afdfe09">NPF_OpenDumpFile</a>(<a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> Open , PUNICODE_STRING fileName, BOOLEAN append);
<a name="l00917"></a>00917 
<a name="l00926"></a>00926 NTSTATUS <a class="code" href="group__NPF__code.html#geffce124cbc3e3ae09bd7a6d10367cbb">NPF_StartDump</a>(<a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> Open);
<a name="l00927"></a>00927 
<a name="l00935"></a>00935 VOID <a class="code" href="group__NPF__code.html#g1566082cef91cf79ba4a855e3f44ede9">NPF_DumpThread</a>(PVOID Open);
<a name="l00936"></a>00936 
<a name="l00943"></a>00943 NTSTATUS <a class="code" href="group__NPF__code.html#gfcdcf5a4d9bfb8fbdb179963d4c789bd">NPF_SaveCurrentBuffer</a>(<a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> Open);
<a name="l00944"></a>00944 
<a name="l00957"></a>00957 VOID <a class="code" href="group__NPF__code.html#g57b9ee7752f00c8858bda8ca060a033b">NPF_WriteDumpFile</a>(PFILE_OBJECT FileObject,
<a name="l00958"></a>00958                                 PLARGE_INTEGER Offset,
<a name="l00959"></a>00959                                 ULONG Length,
<a name="l00960"></a>00960                                 PMDL Mdl,
<a name="l00961"></a>00961                                 PIO_STATUS_BLOCK IoStatusBlock);
<a name="l00962"></a>00962 
<a name="l00963"></a>00963 
<a name="l00964"></a>00964 
<a name="l00970"></a>00970 NTSTATUS <a class="code" href="group__NPF__code.html#gc911742b9f71c12c77452614db14c4a1">NPF_CloseDumpFile</a>(<a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> Open);
<a name="l00971"></a>00971 
<a name="l00972"></a>00972 VOID
<a name="l00973"></a>00973 <a class="code" href="group__NPF__code.html#gb282095d6b161cba67f29f5b59de06a6">NPF_CloseOpenInstance</a>(<a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> pOpen);
<a name="l00974"></a>00974 
<a name="l00975"></a>00975 BOOLEAN
<a name="l00976"></a>00976 <a class="code" href="group__NPF__code.html#g64dab96bfced5d22cc55a42fc6339833">NPF_StartUsingBinding</a>(
<a name="l00977"></a>00977     IN <a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> pOpen);
<a name="l00978"></a>00978 
<a name="l00979"></a>00979 VOID
<a name="l00980"></a>00980 <a class="code" href="group__NPF__code.html#gcd54077d4c2d9186486d3504523ba4f0">NPF_StopUsingBinding</a>(
<a name="l00981"></a>00981     IN <a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> pOpen);
<a name="l00982"></a>00982 
<a name="l00983"></a>00983 VOID
<a name="l00984"></a>00984 <a class="code" href="group__NPF__code.html#g76d4e48415cea8e0e65ba93d7355b89f">NPF_CloseBinding</a>(
<a name="l00985"></a>00985     IN <a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> pOpen);
<a name="l00986"></a>00986 
<a name="l00987"></a>00987 NTSTATUS
<a name="l00988"></a>00988 <a class="code" href="group__NPF__code.html#g8bad85679d2e8c57f7501052f9b07284">NPF_GetDeviceMTU</a>(
<a name="l00989"></a>00989              IN <a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> pOpen,
<a name="l00990"></a>00990              IN PIRP    pIrp,
<a name="l00991"></a>00991              OUT PUINT  pMtu);
<a name="l00992"></a>00992 
<a name="l00997"></a>00997 UINT <a class="code" href="group__NPF__code.html#gdd6737f745e21b37b8613b489a96687d">GetBuffOccupation</a>(<a class="code" href="group__NPF__include.html#gd3b7ff25cfe0e8fd50666782f85e76cb">POPEN_INSTANCE</a> Open);
<a name="l00998"></a>00998 
<a name="l01010"></a>01010 <span class="preprocessor">#ifdef NDIS50</span>
<a name="l01011"></a>01011 <span class="preprocessor"></span>NDIS_STATUS NPF_PowerChange(IN NDIS_HANDLE ProtocolBindingContext, IN PNET_PNP_EVENT pNetPnPEvent);
<a name="l01012"></a>01012 <span class="preprocessor">#endif</span>
<a name="l01013"></a>01013 <span class="preprocessor"></span>
<a name="l01014"></a>01014 <span class="comment">//  </span>
<a name="l01015"></a>01015 <span class="comment">//  Old registry based WinPcap names</span>
<a name="l01016"></a>01016 <span class="comment">//</span>
<a name="l01018"></a>01018 <span class="comment"></span><span class="comment">//  \brief Helper function to query a value from the global WinPcap registry key</span>
<a name="l01019"></a>01019 <span class="comment">//*/</span>
<a name="l01020"></a>01020 <span class="comment">//VOID NPF_QueryWinpcapRegistryString(PWSTR SubKeyName,</span>
<a name="l01021"></a>01021 <span class="comment">//                               WCHAR *Value,</span>
<a name="l01022"></a>01022 <span class="comment">//                               UINT ValueLen, </span>
<a name="l01023"></a>01023 <span class="comment">//                               WCHAR *DefaultValue);</span>
<a name="l01024"></a>01024 <span class="comment">//</span>
<a name="l01025"></a>01025 
<a name="l01026"></a>01026 
<a name="l01035"></a>01035 <span class="preprocessor">#endif  </span><span class="comment">/*main ifndef/define*/</span>
</pre></div>
<hr>
<p align="right"><img border="0" src="winpcap_small.gif" align="absbottom" width="91" height="27">
documentation. Copyright (c) 2002-2005 Politecnico di Torino. Copyright (c) 2005-2007 
CACE Technologies. All rights reserved.</p>
